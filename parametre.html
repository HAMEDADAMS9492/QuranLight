<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Param√®tres - QuranLight</title>

    <script src="assets/js/theme-loader.js"></script>

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/theme-variables.css" />

    <style>
      /* Styles sp√©cifiques √† la mise en page des r√©glages */
      body {
        /* Utilisation des variables pour la compatibilit√© totale avec le loader */
        background-color: var(--emerald-dark);
        background: radial-gradient(
          circle at top,
          var(--emerald-mid),
          var(--emerald-dark)
        );
        background-attachment: fixed;
        color: white;
        font-family: "Poppins", sans-serif;
        margin: 0;
        padding-bottom: 50px;
        overflow-x: hidden;
        transition: background 0.5s ease;
      }

      .settings-header {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        align-items: center;
        padding: 15px 30px;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(20px);
        border-bottom: 1px solid var(--border-light);
        position: sticky;
        top: 0;
        z-index: 1000;
      }

      .back-home {
        text-decoration: none;
        color: white;
        background: rgba(255, 255, 255, 0.05);
        padding: 8px 12px;
        border-radius: 10px;
        border: 1px solid var(--border-light);
        font-size: 0.85rem;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: 0.3s;
        width: fit-content;
      }

      .back-home:hover {
        background: var(--gold);
        color: var(--emerald-dark);
        border-color: var(--gold-bright);
        box-shadow: 0 0 15px var(--gold-glow);
      }

      .header-center {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .header-center i {
        font-size: 1.8rem;
        color: var(--gold);
        filter: drop-shadow(0 0 8px var(--gold-glow));
        animation: spin-slow 10s linear infinite;
      }

      .header-center h1 {
        margin: 0;
        font-size: 1.3rem;
        letter-spacing: 1.5px;
        text-transform: uppercase;
        font-weight: 600;
        background: linear-gradient(to right, #fff, var(--gold-bright));
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      @keyframes spin-slow {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }

      .settings-container {
        max-width: 700px;
        margin: 40px auto;
        padding: 0 20px;
      }

      .settings-section {
        margin-bottom: 45px;
      }

      .section-title {
        color: var(--gold-bright);
        font-size: 0.85rem;
        text-transform: uppercase;
        letter-spacing: 3px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
        opacity: 0.9;
      }

      .section-title::after {
        content: "";
        height: 1px;
        background: linear-gradient(to right, var(--border-light), transparent);
        flex-grow: 1;
      }

      .settings-card {
        background: var(--card-bg);
        border: 1px solid var(--border-light);
        border-radius: 12px;
        overflow: hidden;
        backdrop-filter: blur(5px);
      }

      .setting-row {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 22px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        transition: 0.3s;
      }

      .setting-row:last-child {
        border-bottom: none;
      }

      .setting-info {
        display: flex;
        align-items: center;
        gap: 18px;
        flex: 1;
      }

      .setting-info i {
        font-size: 1.2rem;
        color: var(--gold);
        width: 25px;
        text-align: center;
      }

      .setting-label {
        display: block;
        font-size: 1rem;
        font-weight: 600;
        color: #fdfdfd;
      }

      .setting-desc {
        display: block;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.5);
        margin-top: 4px;
        line-height: 1.4;
      }

      select {
        background: var(--emerald-dark);
        color: var(--gold-bright);
        border: 1px solid var(--border-light);
        padding: 10px 15px;
        border-radius: 8px;
        outline: none;
        cursor: pointer;
      }

      input[type="range"] {
        width: 100%;
        accent-color: var(--gold);
        height: 5px;
        margin-top: 15px;
      }

      .switch {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 26px;
      }

      .switch input {
        opacity: 0;
        width: 0;
        height: 0;
      }

      .slider {
        position: absolute;
        cursor: pointer;
        inset: 0;
        background-color: rgba(255, 255, 255, 0.1);
        transition: 0.4s;
        border-radius: 34px;
        border: 1px solid var(--border-light);
      }

      .slider:before {
        position: absolute;
        content: "";
        height: 18px;
        width: 18px;
        left: 4px;
        bottom: 3px;
        background-color: white;
        transition: 0.4s;
        border-radius: 50%;
      }

      input:checked + .slider {
        background-color: var(--gold);
      }
      input:checked + .slider:before {
        transform: translateX(24px);
      }

      .preview-box {
        background: rgba(0, 0, 0, 0.4);
        border: 1px solid var(--gold);
        border-radius: 12px;
        padding: 25px;
        margin-top: 20px;
        text-align: center;
        position: relative;
      }

      .preview-label {
        position: absolute;
        top: -10px;
        left: 20px;
        background: var(--gold);
        color: var(--emerald-dark);
        font-size: 0.7rem;
        padding: 2px 10px;
        border-radius: 4px;
        font-weight: 800;
        text-transform: uppercase;
      }

      .btn-danger {
        background: rgba(255, 68, 68, 0.1);
        border: 1px solid rgba(255, 68, 68, 0.4);
        color: #ff6666;
        padding: 12px 24px;
        border-radius: 10px;
        font-weight: 600;
        cursor: pointer;
        transition: 0.3s;
        text-transform: uppercase;
        font-size: 0.8rem;
      }

      .btn-danger:hover {
        background: #ff4444;
        color: white;
      }

      @media (max-width: 600px) {
        .settings-header {
          grid-template-columns: auto 1fr;
          gap: 15px;
        }
        .back-home span {
          display: none;
        }
        .setting-row {
          flex-direction: column;
          align-items: flex-start;
          gap: 15px;
        }
        select {
          width: 100%;
        }
        .switch {
          align-self: flex-end;
        }
      }
    </style>
  </head>
  <body>
    <header class="settings-header">
      <a href="index.html" class="back-home">
        <i class="fas fa-home"></i> <span>Accueil</span>
      </a>
      <div class="header-center">
        <i class="fas fa-cog"></i>
        <h1>R√©glages G√©n√©raux</h1>
      </div>
      <div></div>
    </header>

    <div class="settings-container">
      <div class="settings-section">
        <div class="section-title">Exp√©rience Spirituelle</div>
        <div class="settings-card">
          <div class="setting-row">
            <div class="setting-info">
              <i class="fas fa-mosque"></i>
              <div>
                <span class="setting-label">Profil d'Apprentissage</span>
                <span class="setting-desc"
                  >Adapte les tutoriels selon votre genre.</span
                >
              </div>
            </div>
            <select id="pref-gender">
              <option value="masculin">üë®&nbsp; Fr√®re</option>
              <option value="feminin">üë©&nbsp; S≈ìur</option>
            </select>
          </div>
          <div class="setting-row">
            <div class="setting-info">
              <i class="fas fa-bell"></i>
              <div>
                <span class="setting-label">Notifications de Dhikr</span>
                <span class="setting-desc"
                  >Rappels discrets pour le Tasbih.</span
                >
              </div>
            </div>
            <label class="switch">
              <input type="checkbox" id="pref-dhikr" checked />
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>

      <div class="settings-section">
        <div class="section-title">Interface & Confort</div>
        <div class="settings-card">
          <div class="setting-row">
            <div class="setting-info">
              <i class="fas fa-palette"></i>
              <div>
                <span class="setting-label">Nuance d'ambiance</span>
                <span class="setting-desc"
                  >Choisissez l'atmosph√®re visuelle.</span
                >
              </div>
            </div>
            <select id="pref-theme">
              <option value="emerald">üå≤ √âmeraude Royale</option>
              <option value="midnight">üåä Bleu Nuit & Argent</option>
              <option value="dark">üåë Velours Noir & Or</option>
            </select>
          </div>

          <div
            class="setting-row"
            style="flex-direction: column; align-items: stretch"
          >
            <div class="setting-info" style="margin-bottom: 10px">
              <i class="fas fa-text-height"></i>
              <span class="setting-label">Taille des caract√®res</span>
            </div>
            <input type="range" id="font-range" min="14" max="32" value="18" />
            <div class="preview-box">
              <div class="preview-label">Aper√ßu direct</div>
              <div
                class="preview-text"
                id="font-preview"
                style="color: var(--gold-bright)"
              >
                "Certes, c'est par l'√©vocation d'Allah que les c≈ìurs
                s'apaisent." (13:28)
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="settings-section">
        <div class="section-title">Confidentialit√©</div>
        <div class="settings-card">
          <div class="setting-row">
            <div class="setting-info">
              <i class="fas fa-database"></i>
              <div>
                <span class="setting-label">Nettoyage des donn√©es</span>
                <span class="setting-desc"
                  >Efface les pr√©f√©rences enregistr√©es.</span
                >
              </div>
            </div>
            <button id="clear-cache" class="btn-danger">R√©initialiser</button>
          </div>
        </div>
      </div>
    </div>

    <script>
      const fontRange = document.getElementById("font-range");
      const fontPreview = document.getElementById("font-preview");
      const genderSelect = document.getElementById("pref-gender");
      const themeSelect = document.getElementById("pref-theme");
      const dhikrToggle = document.getElementById("pref-dhikr");

      function loadSettings() {
        const settings =
          JSON.parse(localStorage.getItem("quranlight_prefs")) || {};

        if (settings.fontSize) {
          fontRange.value = settings.fontSize;
          fontPreview.style.fontSize = settings.fontSize + "px";
        }
        if (settings.gender) genderSelect.value = settings.gender;
        if (settings.theme) {
          themeSelect.value = settings.theme;
          applyTheme(settings.theme);
        }
        if (settings.dhikr !== undefined) dhikrToggle.checked = settings.dhikr;
      }

      function saveSetting(key, value) {
        let settings =
          JSON.parse(localStorage.getItem("quranlight_prefs")) || {};
        settings[key] = value;
        localStorage.setItem("quranlight_prefs", JSON.stringify(settings));
      }

      function applyTheme(themeName) {
        // Nettoyer les classes existantes
        document.body.classList.remove("theme-midnight", "theme-dark");
        document.documentElement.classList.remove(
          "theme-midnight",
          "theme-dark"
        );

        // Appliquer la nouvelle classe
        if (themeName !== "emerald") {
          document.body.classList.add(`theme-${themeName}`);
          document.documentElement.classList.add(`theme-${themeName}`);
        }
      }

      themeSelect.addEventListener("change", (e) => {
        applyTheme(e.target.value);
        saveSetting("theme", e.target.value);
      });

      fontRange.addEventListener("input", (e) => {
        fontPreview.style.fontSize = e.target.value + "px";
        saveSetting("fontSize", e.target.value);
      });

      genderSelect.addEventListener("change", (e) =>
        saveSetting("gender", e.target.value)
      );
      dhikrToggle.addEventListener("change", (e) =>
        saveSetting("dhikr", e.target.checked)
      );

      document.getElementById("clear-cache").addEventListener("click", () => {
        if (confirm("R√©initialiser toutes vos pr√©f√©rences ?")) {
          localStorage.removeItem("quranlight_prefs");
          location.reload();
        }
      });

      // Lancer au chargement
      loadSettings();
    </script>
  </body>
</html>
